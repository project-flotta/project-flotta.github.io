<!DOCTYPE html>
<html lang="en">

<head>
  <script id="dpal" src="//www.redhat.com/ma/dpal.js" type="text/javascript"></script>
  <meta charset="utf-8">
  <title>Project Flotta</title>

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="this is meta description">

  

  <!-- ** Plugins Needed for the Project ** -->
  
  <link rel="stylesheet" href="/assets/plugins/bootstrap/bootstrap.min.css">
  
  <link rel="stylesheet" href="/assets/plugins/themify-icons/themify-icons.css">
  
  <link rel="stylesheet" href="/assets/plugins/slick/slick.css">
  

  <link href="/assets/scss/syntax_monokai.css" rel="stylesheet">
  <!-- Main Stylesheet -->
  <link href="/assets/scss/style.css" rel="stylesheet">

  <!--Favicon-->
  <link rel="shortcut icon" href="/assets/images/favicon.png " type="image/x-icon">
  <link rel="icon" href="/assets/images/flotta-logo-stacked.ico " type="image/x-icon">

  <!-- google analytics -->
  

</head>


<body>

  <header class="navigation fixed-top nav-bg">
  <nav class="navbar navbar-expand-lg navbar-dark">
    <a class="navbar-brand font-tertiary h3" href="/">
      
        <img src="/assets/images/flotta-logo.png" alt="Project Flotta" style="height: 60px;">
        
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navigation"
      aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse text-center" id="navigation">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item active">
          <a class="nav-link" href="/">Home</a>
        </li>
        
          <li class="nav-item ">
            <a class="nav-link" href="/blog.html">Blog</a>
          </li>
        
          <li class="nav-item ">
            <a class="nav-link" href="/documentation/v0_2_0/intro/overview.html">Documentation</a>
          </li>
        
      </ul>
    </div>
  </nav>
</header>


  <section class="section skip_top">
  <div class="container">
    <div class="row">
      <div class="col-lg-4">
        
        
        <ul class="list-group list-group-collapse border-0">
          
          <li class="list-group-item border-0">
            <h5>
              
              Intro
              
            </h5>
            
            <ul class="list-group border-0">
              
              
              <li class="list-group-item border-0"> <a href="/documentation/v0_2_0/intro/overview.html">What is flotta</a> </li>
              
              
              <li class="list-group-item border-0"> <a href="/documentation/v0_2_0/intro/usecases.html">Use cases</a> </li>
              
              
              <li class="list-group-item border-0"> <a href="/documentation/v0_2_0/intro/vs.html">Flotta vs others</a> </li>
              
              
              <li class="list-group-item border-0"> <a href="/documentation/v0_2_0/intro/concepts.html">Concepts</a> </li>
              
            </ul>
            
          </li>
          
          <li class="list-group-item border-0">
            <h5>
              
              Getting started
              
            </h5>
            
            <ul class="list-group border-0">
              
              
              <li class="list-group-item border-0"> <a href="/documentation/v0_2_0/gsg/minikube.html">Minikube</a> </li>
              
              
              <li class="list-group-item border-0"> <a href="/documentation/v0_2_0/gsg/kind.html">Kind</a> </li>
              
              
              <li class="list-group-item border-0"> <a href="/documentation/v0_2_0/gsg/ocp.html">OCP</a> </li>
              
              
              <li class="list-group-item border-0"> <a href="/documentation/v0_2_0/gsg/running_workloads.html">Running workloads</a> </li>
              
            </ul>
            
          </li>
          
          <li class="list-group-item border-0">
            <h5>
              
              Operations
              
            </h5>
            
            <ul class="list-group border-0">
              
              
              <li class="list-group-item border-0"> <a href="/documentation/v0_2_0/operations/requirements.html">System Requirements</a> </li>
              
              
              <li class="list-group-item border-0"> <a href="/documentation/v0_2_0/operations/deployment_options.html">Deployment options</a> </li>
              
              
              <li class="list-group-item border-0"> <a href="/documentation/v0_2_0/operations/configuration.html">Configuration</a> </li>
              
              
              <li class="list-group-item border-0"> <a href="/documentation/v0_2_0/operations/remote_data_store.html">Remote Edge Configuration API</a> </li>
              
              
              <li class="list-group-item border-0"> <a href="/documentation/v0_2_0/operations/observability.html">Observability</a> </li>
              
              
              <li class="list-group-item border-0"> <a href="/documentation/v0_2_0/operations/data_synchronization.html">Data Synchronization</a> </li>
              
              
              <li class="list-group-item border-0"> <a href="/documentation/v0_2_0/operations/troubleshooting.html">Troubleshooting</a> </li>
              
              
              <li class="list-group-item border-0"> <a href="/documentation/v0_2_0/operations/api.html">API reference</a> </li>
              
              
              <li class="list-group-item border-0"> <a href="/documentation/v0_2_0/operations/crd.html">CRD reference</a> </li>
              
              
              <li class="list-group-item border-0"> <a href="/documentation/v0_2_0/operations/host_devices.html">Accessing host devices</a> </li>
              
            </ul>
            
          </li>
          
          <li class="list-group-item border-0">
            <h5>
              
              For developers
              
            </h5>
            
            <ul class="list-group border-0">
              
              
              <li class="list-group-item border-0"> <a href="/documentation/v0_2_0/dev/installation.html">Manual installation & tips</a> </li>
              
              
              <li class="list-group-item border-0"> <a href="/documentation/v0_2_0/dev/guide.html">Development Guide</a> </li>
              
              
              <li class="list-group-item border-0"> <a href="/documentation/v0_2_0/dev/profiling.html">Profiling</a> </li>
              
            </ul>
            
          </li>
          
        </ul>
        <p>Documentation for version: <b>v0.2.0</b></p>
        <ul class="list-group list-group-collapse border-0">
          <li class="list-group-item border-0">
            <h5>Other versions</h5>

            <ul class="list-group border-0">
              
              
              
              
              <li class="list-group-item border-0"> <a href="/documentation/v0_1_0/intro/overview.html"> v0.1.0</a> </li>
              
              
              
              
              <li class="list-group-item border-0"> <a href="/documentation/latest/intro/overview.html"> latest</a> </li>
              
              
              
              
              <li class="list-group-item border-0"> <a href="/documentation/v0_2_0/intro/overview.html"> v0.2.0</a> </li>
              
            </ul>
          </li>

        </ul>
      </div>

      <div class="col-lg-8">
        <div class="documentation content">
          
          

          <h1 id="remote-data-store-for-flotta-edge-api">Remote data store for Flotta Edge API</h1>

<h2 id="introduction">Introduction</h2>

<p>By default Flotta Edge API uses Kubernetes and CRD-based storage as a source of truth about managed Edge entities -
<code class="language-plaintext highlighter-rouge">EdgeDevice</code> and <code class="language-plaintext highlighter-rouge">EdgeWorkload</code>. All the other CRDs serve as support for better device management in Kubernetes
environment.</p>

<p><img src="/documentation/v0_2_0/diagrams/edge_api.png" alt="" /></p>

<p>Users might want to store their device configuration data in some other place than Kubernetes etcd. To support that
use-case we provide a way to use that external data store (or to be precise - data store service) in Flotta Edge API. 
That data store service is responsible for managing three aspects of device data life cycle:</p>
<ul>
  <li>enrolment and registration - accepting requests from devices to be enqueued for registration approval and then registration;</li>
  <li>providing device configuration;</li>
  <li>heartbeat handling - recording (or <em>ignoring</em>) information sent with each device heartbeat.</li>
</ul>

<p>On the diagram below you can see <em>Flotta Edge API</em> still providing data to a <em>Device</em> in the same way as it is happening
now. The difference is that Device configuration (including workload definitions) is read from an external service
represented by <em>Edge Configuration API</em>, which in turn uses its own data store - <em>EdgeConfigurationProvider</em>. It is
responsible for providing said Device configuration in format defined by Flotta. The heartbeat messages will be sent to
<em>Edge Configuration API</em> as well. <em>etcd</em> on the diagram is used only for storing objects being under supervision of
<em>Flotta Edge API</em>, like Secrets with mTLS certificates used for <em>Device-Flotta Edge API</em> communication.</p>

<p><strong>Warning!</strong></p>

<p><em>Flotta Operator can’t use custom, external data store and its functionality, if needed, has to be implemented by the
users</em></p>

<p><img src="/documentation/v0_2_0/diagrams/edge_api_remote_db.png" alt="" /></p>

<h2 id="flotta-edge-api-configuration-for-remote-data-store">Flotta Edge API configuration for remote data store</h2>

<h3 id="prerequisites">Prerequisites</h3>

<ul>
  <li>HTTP service
providing <a href="/documentation/v0_2_0/operations/configuration-api.html">Edge Configuration API</a>.
You can take inspiration from
our <a href="https://github.com/project-flotta/flotta-operator/blob/main/internal/edgeapi/backend/remote/backend_integration_test.go">integration test</a>
and
a <a href="https://github.com/project-flotta/flotta-operator/blob/main/internal/edgeapi/backend/remote/fake-server_test.go">fake server implementation</a>
;</li>
  <li>Flotta Edge API deployed - as part of the whole Flotta deployment or a standalone deployment (Flotta operator would be
useless);</li>
  <li>Edge Configuration API server has to be reachable from Flotta Edge API pod;</li>
</ul>

<h3 id="flotta-edge-api-configuration">Flotta Edge API configuration</h3>

<p>Flotta Edge API configuration can be found in <code class="language-plaintext highlighter-rouge">flotta-edge-api-config</code> ConfigMap in <code class="language-plaintext highlighter-rouge">flotta</code> namespace. To configure
remote storage, you need to set following properties in that config map:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>BACKEND=remote
REMOTE_BACKEND_URL=&lt;URL to your Edge Configuration API server&gt;
</code></pre></div></div>

<p>You can optionally set <code class="language-plaintext highlighter-rouge">REMOT_BACKEND_TIMEOUT=&lt;duration&gt;</code> to specify timeout on Edge Configuration API HTTP requests.</p>

<p>If you want to protect your Edge Configuration API with mTLS, you need to use Flotta CA to sign your server certificate
and verify client certificate against the same CA. Flotta CA is stored in <code class="language-plaintext highlighter-rouge">flotta-ca</code> Secret in <code class="language-plaintext highlighter-rouge">flotta</code> namespace.
Flotta will be using client certificate stored in <code class="language-plaintext highlighter-rouge">flotta-host-certificate</code> Secret in <code class="language-plaintext highlighter-rouge">flotta</code> namespace. mTLS will
turned automatically on if your <code class="language-plaintext highlighter-rouge">REMOTE_BACKEND_URL</code> uses <code class="language-plaintext highlighter-rouge">https</code>.</p>

<p>After Flotta Edge API pod is restarted, it will be using your new configuration.</p>

        </div>
      </div>
    </div>
  </div>
</section>

  <!-- footer -->
<footer class="bg-dark footer-section">
  <div class="section">
    <div class="container">
      <div class="row">
        <div class="col-md-4">
          <h5 class="text-light">Email</h5>
          <p class="text-white paragraph-lg font-secondary">flotta@redhat.com</p>
        </div>
        <div class="col-md-4">
          <h5><a href="http://www.redhat.com"><img id="sponsorship" class="footerLogo" src="/assets/images/Logo-Red_Hat-Supported_By-A-Reverse-RGB.svg"></a>.</h5>
        </div>
        <!-- <div class="col-md-4"> -->
        <!--   <h5 class="text-light">Address</h5> -->
        <!--   <p class="text-white paragraph-lg font-secondary"></p> -->
        <!-- </div> -->
      </div>
    </div>
  </div>
  <div class="border-top text-center border-dark py-5">
    <p class="mb-0 text-light"><p>Copyright © 2020 Designed by <a href="https://themefisher.com">Themefisher</a> &amp; Developed by <a href="https://getjekyllthemes.com">Getjekyllthemes</a></p>
</p>
  </div>
</footer>
<!-- /footer -->


<!-- JS Plugins -->

<script src="/assets/plugins/jQuery/jquery.min.js"></script>

<script src="/assets/plugins/bootstrap/bootstrap.min.js"></script>

<script src="/assets/plugins/shuffle/shuffle.min.js"></script>

<script src="/assets/plugins/slick/slick.min.js"></script>


<!-- Main Script -->
<script src="/assets/js/script.js"></script>

<!-- This comes from DTM/DPAL and must be latest entry in body-->
<script type="text/javascript">
  if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
      _satellite.pageBottom();
  }
</script>


<script>
  $(function() {
    return $("h2, h3, h4, h5, h6").each(function(i, el) {
      var $el, icon, id;
      $el = $(el);
      id = $el.attr('id');
      icon = '<i class="ti-link"></i>';
      console.log("test test"+id)
      if (id) {
        return $el.prepend($("<a />").addClass("header-link").attr("href", "#" + id).html(icon));
      }
    });
  });
</script>


</body>

</html>
